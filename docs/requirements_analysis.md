# SEAL 需求分析文档

## 项目概述

### 项目背景
SEAL 是一个用于 MEG/EEG 源成像分析的 MATLAB 平台，具备**数据管理、预处理、源成像算法、可视化与仿真验证**五大核心模块。现计划基于 **MATLAB App Designer** 对系统进行重构，提升界面交互性、代码可维护性与用户体验。

### 系统目标
- 构建一个**模块化、开放、可扩展**的源成像分析平台
- 支持**多格式数据导入**与标准化处理流程
- 提供**图形化交互界面**，降低非编程用户使用门槛
- 集成**多种源成像算法**，支持仿真与性能评估

---

## 用户角色

| 角色 | 主要需求 |
|------|-----------|
| 神经影像研究者 | 直观的数据导入、预处理、源成像分析、结果可视化 |
| 算法开发者 | 算法集成接口、仿真数据生成、性能评估工具 |
| 非编程用户 | 图形化操作、流程化分析、结果导出 |

---

## 功能需求

### 项目管理模块（SEAL_GUI.mlapp）

| 功能 | 需求描述 | 优先级 | 状态 |
|------|-----------|---------|------|
| 项目/协议分级管理 | 支持树形结构 | 高 | 已完成 |
| 多格式数据导入 | 支持 .mat, .set，并提供 EEGLAB 车换功能 | 低 | 待实现 |
| 项目创建 | 创建新项目，设置项目名称和路径 | 高 | 已完成 |
| 项目打开 | 打开现有项目 | 高 | 已完成 |
| 项目保存 | 保存项目数据 | 高 | 已完成 |
| 项目删除 | 删除项目 | 高 | 已完成 |

### 协议管理模块（SEAL_Newprotocol.mlapp）

| 功能 | 需求描述 | 优先级 | 状态 |
|------|-----------|---------|------|
| 协议创建 | 创建新协议，设置协议名称和类型 | 高 | 已完成 |
| 协议打开 | 打开现有协议 | 高 | 已完成 |
| 协议保存 | 保存协议数据 | 高 | 已完成 |
| 协议删除 | 删除协议 | 高 | 已完成 |
| 通道管理 | 导入和管理通道信息 | 高 | 已完成 |
| 皮层管理 | 导入和管理皮层信息 | 高 | 已完成 |
| 导联场管理 | 导入和管理导联场信息 | 高 | 已完成 |

### 会话管理模块

| 功能 | 需求描述 | 优先级 | 状态 |
|------|-----------|---------|------|
| 会话创建 | 创建新会话 | 高 | 已完成 |
| 会话打开 | 打开现有会话 | 高 | 已完成 |
| 会话保存 | 保存会话数据 | 高 | 已完成 |
| 会话删除 | 删除会话 | 高 | 已完成 |
| 数据导入 | 导入数据文件 | 高 | 已完成 |

### 预处理模块（SEAL_Preprocess.mlapp）

| 功能 | 需求描述 | 优先级 | 状态 |
|------|-----------|---------|------|
| 时域滤波 | 高通、低通、带通、带阻滤波器 | 高 | 已完成 |
| 时频分析 | STFT、小波变换、降采样 | 高 | 部分完成 |
| 空间滤波 | Laplacian、PCA、ICA 伪迹剔除 | 高 | 部分完成 |
| 事件相关分析 | 分段、基线校正、叠加平均 | 高 | 待实现 |
| 噪声协方差估计 | 自动计算与白化算子生成 | 高 | 待实现 |
| 实时频谱显示 | 支持通道选择与功率谱实时更新 | 中 | 待实现 |
| 数据保存机制 | 预处理结果应可被后续模块调用 | 高 | 已完成 |

### 源成像算法模块（SEAL_selectAlgorithm.mlapp）

| 功能 | 需求描述 | 优先级 | 状态 |
|------|-----------|---------|------|
| 算法集成 | MNE, dSPM, LORETA, sLORETA, eLORETA, LAURA | 高 | 已完成 |
| 时空算法 | BlockChampagne, STARTS, uSTAR | 高 | 已完成 |
| 统一算法接口 | 输入：Leadfield、噪声协方差、正则化参数 | 高 | 已完成 |
| 参数可视化设置 | 支持不同算法类别的参数面板 | 高 | 已完成 |
| 偶极子方向设置 | 自由/固定方向选择 | 高 | 已完成 |
| 结果保存与节点管理 | 结果保存为 Data 节点，与 Data 关联 | 高 | 已完成 |
| 算法窗口管理 | 避免重叠，自动调整位置，减少弹窗 | 中 | 待实现 |

### 可视化模块

| 功能 | 需求描述 | 优先级 | 状态 |
|------|-----------|---------|------|
| 信号可视化 | 时间序列、功率谱、拓扑图同步更新 | 高 | 部分完成 |
| 源成像结果可视化 | 3D 脑模型渲染，支持时间点交互 | 高 | 部分完成 |
| ROI 选择与提取 | 支持脑区掩膜、多选/单选模式 | 高 | 待实现 |
| 多视图同步 | 支持信号-源空间-时间域联动 | 高 | 待实现 |
| 通道显示优化 | 支持通道数过多时的显示调整 | 中 | 待实现 |

### 仿真验证模块

| 功能 | 需求描述 | 优先级 | 状态 |
|------|-----------|---------|------|
| 仿真数据生成 | 生成仿真EEG/MEG数据 | 中 | 待实现 |
| 性能评估 | 算法性能评估工具 | 中 | 待实现 |

---

## 非功能需求

| 类别 | 需求描述 | 状态 |
|------|-----------|------|
| 性能 | 交互响应时间 < 150ms，支持大规模数据加载与处理 | 部分完成 |
| 交互优化 | 超过0.1秒的长等待显示进度条 | 部分完成 |
| 可用性 | 图形化界面，操作流程清晰，学习曲线低 | 部分完成 |
| 可维护性 | 面向对象模块化设计，接口统一，便于扩展与调试 | 已完成 |
| 可扩展性 | 支持插件和算法扩展 | 已完成 |

---

## 用户界面需求

| 功能 | 需求描述 | 优先级 | 状态 |
|------|-----------|---------|------|
| 选中效果优化 | 重新梳理类关系，提高选中效果，部分按钮选中后显示 | 中 | 待实现 |
| 交互反馈 | 避免右击和弹窗，操作给出明确反馈 | 中 | 部分完成 |
| 树形结构显示 | 显示项目-协议-会话-数据的树形结构 | 高 | 已完成 |
| 节点信息显示 | 显示选中节点的详细信息 | 高 | 已完成 |

---

## 数据需求

### 数据结构需求

| 需求 | 描述 | 状态 |
|------|------|------|
| 节点系统 | 采用树形节点系统管理所有数据 | 已完成 |
| 数据与元数据分离 | 真实数据存储在文件系统中，内存中仅维护元数据和路径引用 | 已完成 |
| 按需加载 | 大数据集按需加载，避免内存溢出 | 已完成 |
| 节点生命周期管理 | 支持创建、打开、加载、保存、卸载、删除 | 已完成 |
| 树形结构管理 | 支持父子关系管理 | 已完成 |
| 事件通知 | 支持节点事件通知 | 已完成 |
| 双向绑定 | 父子节点双向绑定 | 已完成 |
| 元数据管理 | 支持元数据管理 | 已完成 |

### 数据存储需求

| 需求 | 描述 | 状态 |
|------|------|------|
| 项目存储 | 项目信息存储在 .mat 文件中 | 已完成 |
| 协议存储 | 协议信息存储在 .mat 文件中 | 已完成 |
| 会话存储 | 会话信息存储在 .mat 文件中 | 已完成 |
| 数据存储 | 数据存储在 .mat 文件中 | 已完成 |
| 通道信息存储 | 通道信息存储在 .mat 文件中 | 已完成 |
| 皮层信息存储 | 皮层信息存储在 .mat 文件中 | 已完成 |
| 导联场信息存储 | 导联场信息存储在 .mat 文件中 | 已完成 |

---

## 技术需求

### 编程语言

| 需求 | 描述 | 状态 |
|------|------|------|
| MATLAB | 使用 MATLAB 作为主要开发语言 | 已完成 |

### 框架和库

| 需求 | 描述 | 状态 |
|------|------|------|
| MATLAB App Designer | 使用 MATLAB App Designer 开发 GUI | 已完成 |
| EEGLAB | 集成 EEGLAB 工具 | 已完成 |
| Brainstorm | 集成 Brainstorm 工具 | 已完成 |

### 代码规范

| 需求 | 描述 | 状态 |
|------|------|------|
| 驼峰式命名 | 变量和函数名使用驼峰式命名 | 部分完成 |
| 帕斯卡命名法 | 类名使用帕斯卡命名法 | 已完成 |
| 大写字母和下划线 | 常量使用大写字母和下划线 | 部分完成 |

---

## 测试需求

| 需求 | 描述 | 状态 |
|------|------|------|
| 单元测试 | 对每个节点类进行单元测试 | 部分完成 |
| 集成测试 | 对整个系统进行集成测试 | 部分完成 |
| 性能测试 | 对系统性能进行测试 | 待实现 |

---

## 文档需求

| 需求 | 描述 | 状态 |
|------|------|------|
| 数据字典 | 建立完整的数据字典文档 | 已完成 |
| 项目结构文档 | 建立项目结构文档 | 已完成 |
| 项目文档 | 建立项目文档 | 已完成 |
| 需求分析文档 | 建立需求分析文档 | 已完成 |
| 存储结构文档 | 建立存储结构文档 | 已完成 |

---

## 未来规划

| 功能 | 描述 | 优先级 |
|------|------|---------|
| 多格式数据导入 | 支持更多数据格式 | 中 |
| 仿真验证模块 | 实现仿真验证功能 | 中 |
| 性能优化 | 进一步优化系统性能 | 中 |
| 算法扩展 | 集成更多源成像算法 | 低 |
| 可视化增强 | 增强可视化功能 | 中 |
